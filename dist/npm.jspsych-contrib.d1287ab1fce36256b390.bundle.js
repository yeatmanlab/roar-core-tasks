"use strict";(self.webpackChunk_bdelab_roar_levantecore_tasks=self.webpackChunk_bdelab_roar_levantecore_tasks||[]).push([[762],{N93M:(t,e,s)=>{s.d(e,{A:()=>i});var o=s("gJmw");const n={name:"audio-multi-response",parameters:{stimulus:{type:o.QL.HTML_STRING,pretty_name:"Stimulus",default:void 0},button_choices:{type:o.QL.STRING,pretty_name:"Button Choices",default:[],array:!0},keyboard_choices:{type:o.QL.KEYS,pretty_name:"Keyboard Choices",default:"NO_KEYS"},button_html:{type:o.QL.HTML_STRING,pretty_name:"Button HTML",default:'<button class="jspsych-btn">%choice%</button>',array:!0},prompt:{type:o.QL.HTML_STRING,pretty_name:"Prompt",default:null},prompt_above_buttons:{type:o.QL.BOOL,pretty_name:"Prompt above buttons",default:!1},trial_duration:{type:o.QL.INT,pretty_name:"Trial duration",default:null},margin_vertical:{type:o.QL.STRING,pretty_name:"Margin vertical",default:"0px"},margin_horizontal:{type:o.QL.STRING,pretty_name:"Margin horizontal",default:"8px"},response_ends_trial:{type:o.QL.BOOL,pretty_name:"Response ends trial",default:!0},trial_ends_after_audio:{type:o.QL.BOOL,pretty_name:"Trial ends after audio",default:!1},response_allowed_while_playing:{type:o.QL.BOOL,pretty_name:"Response allowed while playing",default:!0}}};class i{constructor(t){this.jsPsych=t}trial(t,e,s){let o;var n=this.jsPsych.pluginAPI.audioContext();let i={rt:null,key:null,button:null,source:null};var r;this.jsPsych.pluginAPI.getAudioBuffer(e.stimulus).then((t=>{null!==n?(this.audio=n.createBufferSource(),this.audio.buffer=t,this.audio.connect(n.destination)):(this.audio=t,this.audio.currentTime=0),a()})).catch((t=>{console.error(`Failed to load audio file "${e.stimulus}". Try checking the file path. We recommend using the preload plugin to load audio files.`),console.error(t)}));const a=()=>{e.trial_ends_after_audio&&this.audio.addEventListener("ended",l),e.response_allowed_while_playing||e.trial_ends_after_audio||(this.audio.addEventListener("ended",h),this.audio.addEventListener("ended",d));var o=[];if(Array.isArray(e.button_html))e.button_html.length==e.button_choices.length?o=e.button_html:console.error("Error in audio-multi-response plugin. The length of the button_html array does not equal the length of the choices array");else for(var i=0;i<e.button_choices.length;i++)o.push(e.button_html);let a='<div id="jspsych-audio-multi-response-btngroup">';for(i=0;i<e.button_choices.length;i++){var u=o[i].replace(/%choice%/g,e.button_choices[i]);a+='<div class="jspsych-audio-multi-response-button" style="cursor: pointer; display: inline-block; margin:'+e.margin_vertical+" "+e.margin_horizontal+'" id="jspsych-audio-multi-response-button-'+i+'" data-choice="'+i+'">'+u+"</div>"}a+="</div>",null!==e.prompt&&(e.prompt_above_buttons?a='<div id="jspsych-audio-multi-response-prompt">'+e.prompt+"</div>"+a:a+='<div id="jspsych-audio-multi-response-prompt">'+e.prompt+"</div>"),t.innerHTML=a,e.response_allowed_while_playing?(d(),h()):c(),r=performance.now(),null!==n?(r=n.currentTime,this.audio.start(r)):this.audio.play(),null!==e.trial_duration&&this.jsPsych.pluginAPI.setTimeout((()=>{l()}),e.trial_duration),s()},l=()=>{this.jsPsych.pluginAPI.clearAllTimeouts(),null!==n?this.audio.stop():this.audio.pause(),this.audio.removeEventListener("ended",l),this.audio.removeEventListener("ended",h),this.audio.removeEventListener("ended",d),this.jsPsych.pluginAPI.cancelAllKeyboardResponses();const s={rt:i.rt,stimulus:e.stimulus,keyboard_response:i.key,button_response:i.button,response_source:i.source};t.innerHTML="",this.jsPsych.finishTrial(s),o()};function u(t){var s,o,a;s=t.currentTarget.getAttribute("data-choice"),o=performance.now(),a=Math.round(o-r),null!==n&&(o=n.currentTime,a=Math.round(1e3*(o-r))),i.button=parseInt(s),i.rt=a,i.source="button",c(),e.response_ends_trial&&l()}function c(){for(var t=document.querySelectorAll(".jspsych-audio-multi-response-button"),e=0;e<t.length;e++){var s=t[e].querySelector("button");s&&(s.disabled=!0),t[e].removeEventListener("click",u)}}function d(){for(var t=document.querySelectorAll(".jspsych-audio-multi-response-button"),e=0;e<t.length;e++){var s=t[e].querySelector("button");s&&(s.disabled=!1),t[e].addEventListener("click",u)}}const p=t=>{null==i.key&&(i=Object.assign({source:"keyboard",button:null},t)),e.response_ends_trial&&l()},h=()=>{if("NO_KEYS"!=e.keyboard_choices){let t;t=null!==n?{rt_method:"audio",audio_context:n,audio_context_start_time:r}:{rt_method:"performance"},this.jsPsych.pluginAPI.getKeyboardResponse(Object.assign({callback_function:p,valid_responses:e.keyboard_choices,persist:!1,allow_held_key:!1},t))}};return new Promise((t=>{o=t}))}simulate(t,e,s,o){"data-only"==e&&(o(),this.simulate_data_only(t,s)),"visual"==e&&this.simulate_visual(t,s,o)}create_simulation_data(t,e){const s={stimulus:t.stimulus,rt:this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0),keyboard_response:this.jsPsych.pluginAPI.getValidKey(t.keyboard_choices),button_response:null,response_source:"keyboard"},o={stimulus:t.stimulus,rt:this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0),button_response:this.jsPsych.randomization.randomInt(0,t.button_choices.length-1),keyboard_response:null,response_source:"button"},n=Math.random()<.5?s:o,i=this.jsPsych.pluginAPI.mergeSimulationData(n,e);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(t,i),i}simulate_data_only(t,e){const s=this.create_simulation_data(t,e);this.jsPsych.finishTrial(s)}simulate_visual(t,e,s){const o=this.create_simulation_data(t,e),n=this.jsPsych.getDisplayElement(),i=()=>{null!==o.rt&&(null!==o.button_response?this.jsPsych.pluginAPI.clickTarget(n.querySelector(`div[data-choice="${o.response}"] button`),o.rt):this.jsPsych.pluginAPI.pressKey(o.keyboard_response,o.rt))};this.trial(n,t,(()=>{s(),t.response_allowed_while_playing?i():this.audio.addEventListener("ended",i)}))}}i.info=n},IhlY:(t,e,s)=>{s.d(e,{A:()=>i});var o=s("gJmw");const n={name:"corsi-blocks",parameters:{sequence:{type:o.QL.INT,default:void 0,array:!0},blocks:{type:o.QL.COMPLEX,array:!0,default:[{y:80,x:45},{y:94,x:80},{y:70,x:20},{y:60,x:70},{y:50,x:35},{y:40,x:6},{y:45,x:94},{y:25,x:60},{y:6,x:47}],nested:{x:{type:o.QL.INT,default:void 0},y:{type:o.QL.INT,default:void 0}}},block_size:{type:o.QL.INT,default:12},display_width:{type:o.QL.STRING,default:"400px"},display_height:{type:o.QL.STRING,default:"400px"},prompt:{type:o.QL.STRING,default:null},mode:{type:o.QL.STRING,default:"display",options:["display","input"]},sequence_gap_duration:{type:o.QL.INT,default:250},sequence_block_duration:{type:o.QL.INT,default:1e3},pre_stim_duration:{type:o.QL.INT,default:500},response_animation_duration:{type:o.QL.INT,default:500},block_color:{type:o.QL.STRING,default:"#555"},highlight_color:{type:o.QL.STRING,default:"#ff0000"},correct_color:{type:o.QL.STRING,default:"#00ff00"},incorrect_color:{type:o.QL.STRING,default:"#ff0000"}}};class i{constructor(t){this.jsPsych=t}trial(t,e){let s=`<style id="jspsych-corsi-css">\n      #jspsych-corsi-stimulus { \n        position: relative; \n        width:${e.display_width}; \n        height:${e.display_height};\n      }\n      .jspsych-corsi-block { \n        background-color: ${e.block_color}; \n        position: absolute; \n        width: ${e.block_size}%; \n        height: ${e.block_size}%;\n        transform: translate(-50%, -50%);\n      }\n      #jspsych-corsi-prompt { \n        position: absolute; \n        text-align: center; \n        width: ${e.display_width}; \n        top: 100%; \n      }\n      #jspsych-corsi-prompt p { \n        font-size: 18px; \n      }\n      ${"input"==e.mode?".jspsych-corsi-block { cursor: pointer; }":""}\n    </style>`;s+='<div id="jspsych-corsi-stimulus">';for(let t=0;t<e.blocks.length;t++)s+=`<div class="jspsych-corsi-block" data-id="${t}" style="top:${e.blocks[t].y}%; left:${e.blocks[t].x}%;"></div>`;null!=e.prompt&&(s+=`<div id="jspsych-corsi-prompt"><p>${e.prompt}</p></div>`),s+="</div>",t.innerHTML=s;const o=performance.now(),n={sequence:e.sequence,response:[],rt:[],blocks:e.blocks,correct:null},i=()=>{t.innerHTML="",this.jsPsych.finishTrial(n)},r=function(t,e){const s=performance.now(),o=(t,e,n)=>{performance.now()-n>=e?t():window.requestAnimationFrame((()=>o(t,e,s)))};window.requestAnimationFrame((()=>o(t,e,s)))};if("display"==e.mode){let s=0,o="pre-stim";const n=()=>{if("pre-stim"==o)r(n,e.pre_stim_duration),o="sequence";else if("sequence"==o){const a=t.querySelector(`.jspsych-corsi-block[data-id="${e.sequence[s]}"]`);s<e.sequence.length&&(a.style.backgroundColor=e.highlight_color,r(n,e.sequence_block_duration),o="iti"),s==e.sequence.length&&i()}else"iti"==o&&(t.querySelector(`.jspsych-corsi-block[data-id="${e.sequence[s]}"]`).style.backgroundColor=e.block_color,s++,r(n,e.sequence_gap_duration),o="sequence")};window.requestAnimationFrame(n)}if("input"==e.mode){const s=[{backgroundColor:e.block_color},{backgroundColor:e.correct_color,offset:.2},{backgroundColor:e.block_color}],r=[{backgroundColor:e.block_color},{backgroundColor:e.incorrect_color,offset:.2},{backgroundColor:e.block_color}],u={duration:e.response_animation_duration,iterations:1},c=a=>{if(null!==n.correct)return;const l=Math.round(performance.now()-o);n.response.push(parseInt(a)),n.rt.push(l),parseInt(a)==e.sequence[n.response.length-1]?(t.querySelector(`.jspsych-corsi-block[data-id="${a}"]`).animate(s,u),n.response.length==e.sequence.length&&(n.correct=!0,setTimeout(i,e.response_animation_duration))):(t.querySelector(`.jspsych-corsi-block[data-id="${a}"]`).animate(r,u),n.correct=!1,setTimeout(i,e.response_animation_duration))};for(var a=t.querySelectorAll(".jspsych-corsi-block"),l=0;l<a.length;l++)a[l].addEventListener("click",(t=>{c(t.target.getAttribute("data-id"))}))}}}i.info=n},pdxl:(t,e,s)=>{s.d(e,{A:()=>i});var o=s("gJmw");const n={name:"html-multi-response",parameters:{stimulus:{type:o.QL.HTML_STRING,pretty_name:"Stimulus",default:void 0},button_choices:{type:o.QL.STRING,pretty_name:"Button Choices",default:[],array:!0},keyboard_choices:{type:o.QL.KEYS,pretty_name:"Keyboard Choices",default:"NO_KEYS"},button_html:{type:o.QL.HTML_STRING,pretty_name:"Button HTML",default:'<button class="jspsych-btn">%choice%</button>',array:!0},prompt:{type:o.QL.HTML_STRING,pretty_name:"Prompt",default:null},stimulus_duration:{type:o.QL.INT,pretty_name:"Stimulus duration",default:null},trial_duration:{type:o.QL.INT,pretty_name:"Trial duration",default:null},margin_vertical:{type:o.QL.STRING,pretty_name:"Margin vertical",default:"0px"},margin_horizontal:{type:o.QL.STRING,pretty_name:"Margin horizontal",default:"8px"},response_ends_trial:{type:o.QL.BOOL,pretty_name:"Response ends trial",default:!0}}};class i{constructor(t){this.jsPsych=t}trial(t,e){var s='<div id="jspsych-html-multi-response-stimulus">'+e.stimulus+"</div>",o=[];if(Array.isArray(e.button_html))e.button_html.length==e.button_choices.length?o=e.button_html:console.error("Error in html-multi-response plugin. The length of the button_html array does not equal the length of the button_choices array");else for(var n=0;n<e.button_choices.length;n++)o.push(e.button_html);for(s+='<div id="jspsych-html-multi-response-btngroup">',n=0;n<e.button_choices.length;n++){var i=o[n].replace(/%choice%/g,e.button_choices[n]);s+='<div class="jspsych-html-multi-response-button" style="display: inline-block; margin:'+e.margin_vertical+" "+e.margin_horizontal+'" id="jspsych-html-multi-response-button-'+n+'" data-choice="'+n+'">'+i+"</div>"}if(s+="</div>",null!==e.prompt&&(s+=e.prompt),t.innerHTML=s,"NO_KEYS"!=e.keyboard_choices)var r=this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:function(s){t.querySelector("#jspsych-html-multi-response-stimulus").className+=" responded",null==l.key&&(l=Object.assign({source:"keyboard",button:null},s)),e.response_ends_trial&&u()},valid_responses:e.keyboard_choices,rt_method:"performance",persist:!1,allow_held_key:!1});var a=performance.now();for(n=0;n<e.button_choices.length;n++)t.querySelector("#jspsych-html-multi-response-button-"+n).addEventListener("click",(t=>{c(t.currentTarget.getAttribute("data-choice"))}));var l={rt:null,button:null,key:null,source:null};const u=()=>{this.jsPsych.pluginAPI.clearAllTimeouts(),void 0!==r&&this.jsPsych.pluginAPI.cancelKeyboardResponse(r);var s={rt:l.rt,stimulus:e.stimulus,button_response:l.button,keyboard_response:l.key,response_source:l.source};t.innerHTML="",this.jsPsych.finishTrial(s)};function c(s){var o=performance.now(),n=Math.round(o-a);l.button=parseInt(s),l.rt=n,l.source="button",t.querySelector("#jspsych-html-multi-response-stimulus").className+=" responded";for(var i=document.querySelectorAll(".jspsych-html-multi-response-button button"),r=0;r<i.length;r++)i[r].setAttribute("disabled","disabled");e.response_ends_trial&&u()}null!==e.stimulus_duration&&this.jsPsych.pluginAPI.setTimeout((()=>{t.querySelector("#jspsych-html-multi-response-stimulus").style.visibility="hidden"}),e.stimulus_duration),null!==e.trial_duration&&this.jsPsych.pluginAPI.setTimeout(u,e.trial_duration)}simulate(t,e,s,o){"data-only"==e&&(o(),this.simulate_data_only(t,s)),"visual"==e&&this.simulate_visual(t,s,o)}create_simulation_data(t,e){const s={stimulus:t.stimulus,rt:this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0),keyboard_response:this.jsPsych.pluginAPI.getValidKey(t.keyboard_choices),button_response:null,response_source:"keyboard"},o={stimulus:t.stimulus,rt:this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0),button_response:this.jsPsych.randomization.randomInt(0,t.button_choices.length-1),keyboard_response:null,response_source:"button"},n=Math.random()<.5?s:o,i=this.jsPsych.pluginAPI.mergeSimulationData(n,e);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(t,i),i}simulate_data_only(t,e){const s=this.create_simulation_data(t,e);this.jsPsych.finishTrial(s)}simulate_visual(t,e,s){const o=this.create_simulation_data(t,e),n=this.jsPsych.getDisplayElement();this.trial(n,t),s(),null!==o.rt&&(null!==o.button_response?this.jsPsych.pluginAPI.clickTarget(n.querySelector(`div[data-choice="${o.button_response}"] button`),o.rt):this.jsPsych.pluginAPI.pressKey(o.keyboard_response,o.rt))}}i.info=n}}]);
//# sourceMappingURL=npm.jspsych-contrib.d1287ab1fce36256b390.bundle.js.map